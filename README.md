# cuda-matrix-multiply
Multiplies 2 square matrices using the CPU and CUDA and compares the time taken.

**Instructions**

- Use a Linux host with an Nvidia CUDA-compatible GPU, and the CUDA toolkit, installed. [See here for details](https://docs.nvidia.com/cuda/cuda-installation-guide-linux/)
- Run *nvidia-smi* to see that your GPU is detected and the expected CUDA version is available.
- Clone this repo to a working directory.
- Ensure that nvcc is available on your path (typically: export PATH=/usr/local/cuda/bin:$PATH, then run *which nvcc* to check)
```
cd cuda-matrix-multiply
make
./matrix_multiply <integer for square matrix side>
```
**Expected output using a small matrix for formatting reasons**
Don't worry - the GPU is faster for matrices over about 50x50!
```
abe@gnometimmy:~/cuda$ ./matrix_multiply 16
Matrix A:
8.0 7.0 5.0 6.0 3.0 0.0 1.0 8.0 8.0 0.0 7.0 7.0 9.0 7.0 1.0 2.0 
8.0 4.0 1.0 3.0 4.0 9.0 4.0 6.0 2.0 2.0 6.0 6.0 8.0 7.0 6.0 8.0 
6.0 3.0 4.0 1.0 3.0 8.0 9.0 4.0 0.0 6.0 3.0 9.0 3.0 4.0 2.0 2.0 
9.0 5.0 7.0 5.0 5.0 1.0 2.0 7.0 5.0 0.0 3.0 6.0 9.0 1.0 4.0 5.0 
4.0 1.0 6.0 9.0 9.0 6.0 3.0 9.0 2.0 7.0 9.0 8.0 3.0 3.0 2.0 4.0 
8.0 9.0 0.0 5.0 2.0 4.0 4.0 9.0 6.0 9.0 5.0 6.0 0.0 2.0 3.0 4.0 
3.0 0.0 4.0 4.0 8.0 9.0 5.0 2.0 6.0 6.0 0.0 2.0 9.0 2.0 6.0 8.0 
3.0 8.0 5.0 5.0 4.0 0.0 7.0 1.0 9.0 2.0 9.0 0.0 6.0 2.0 6.0 9.0 
4.0 0.0 5.0 4.0 0.0 1.0 7.0 8.0 7.0 9.0 2.0 9.0 4.0 9.0 9.0 7.0 
9.0 4.0 5.0 6.0 6.0 2.0 9.0 6.0 6.0 8.0 8.0 3.0 2.0 4.0 4.0 9.0 
7.0 0.0 3.0 9.0 3.0 2.0 7.0 2.0 2.0 0.0 1.0 6.0 1.0 0.0 5.0 0.0 
7.0 0.0 8.0 3.0 2.0 7.0 1.0 1.0 5.0 9.0 4.0 0.0 6.0 8.0 9.0 3.0 
0.0 2.0 2.0 5.0 5.0 1.0 8.0 9.0 3.0 9.0 5.0 4.0 2.0 2.0 7.0 9.0 
3.0 5.0 4.0 7.0 3.0 6.0 8.0 0.0 5.0 4.0 0.0 3.0 5.0 1.0 8.0 5.0 
4.0 2.0 1.0 1.0 4.0 9.0 0.0 7.0 0.0 7.0 4.0 4.0 9.0 1.0 3.0 2.0 
8.0 8.0 2.0 3.0 6.0 0.0 6.0 1.0 7.0 8.0 7.0 2.0 0.0 5.0 7.0 6.0 

Matrix B:
8.0 0.0 7.0 4.0 1.0 7.0 1.0 2.0 4.0 7.0 8.0 3.0 0.0 4.0 8.0 9.0 
4.0 0.0 4.0 0.0 2.0 0.0 3.0 9.0 9.0 0.0 1.0 1.0 6.0 1.0 7.0 4.0 
3.0 4.0 0.0 5.0 1.0 3.0 9.0 7.0 1.0 7.0 2.0 1.0 1.0 0.0 2.0 5.0 
2.0 7.0 5.0 5.0 9.0 9.0 6.0 8.0 1.0 0.0 1.0 7.0 3.0 8.0 3.0 6.0 
2.0 3.0 3.0 5.0 7.0 2.0 2.0 0.0 2.0 5.0 1.0 5.0 7.0 6.0 1.0 0.0 
3.0 8.0 7.0 4.0 9.0 5.0 5.0 1.0 7.0 6.0 0.0 0.0 5.0 4.0 9.0 7.0 
9.0 2.0 5.0 6.0 7.0 7.0 6.0 9.0 4.0 0.0 4.0 4.0 6.0 7.0 6.0 1.0 
6.0 3.0 7.0 7.0 0.0 2.0 8.0 8.0 9.0 9.0 8.0 4.0 5.0 7.0 3.0 4.0 
2.0 8.0 3.0 9.0 8.0 1.0 8.0 4.0 1.0 4.0 8.0 9.0 2.0 6.0 2.0 0.0 
1.0 0.0 7.0 2.0 2.0 8.0 0.0 3.0 7.0 0.0 9.0 4.0 0.0 5.0 8.0 2.0 
5.0 1.0 1.0 3.0 5.0 1.0 0.0 8.0 5.0 0.0 8.0 9.0 7.0 2.0 9.0 8.0 
4.0 7.0 0.0 7.0 5.0 2.0 2.0 4.0 5.0 2.0 8.0 5.0 9.0 8.0 9.0 4.0 
0.0 2.0 8.0 7.0 5.0 0.0 5.0 0.0 0.0 5.0 0.0 7.0 8.0 1.0 8.0 2.0 
8.0 0.0 1.0 5.0 3.0 6.0 9.0 0.0 0.0 9.0 5.0 9.0 8.0 6.0 3.0 0.0 
0.0 3.0 7.0 5.0 3.0 2.0 7.0 4.0 0.0 9.0 3.0 8.0 1.0 1.0 2.0 9.0 
2.0 6.0 7.0 7.0 2.0 6.0 7.0 2.0 8.0 4.0 3.0 6.0 0.0 6.0 6.0 2.0 

GPU Result (C = A * B):
321.0 250.0 315.0 423.0 316.0 239.0 393.0 359.0 282.0 349.0 378.0 445.0 389.0 350.0 423.0 309.0 
328.0 281.0 419.0 433.0 356.0 317.0 401.0 302.0 353.0 400.0 348.0 435.0 387.0 376.0 503.0 364.0 
302.0 216.0 298.0 327.0 290.0 289.0 286.0 286.0 308.0 264.0 313.0 280.0 320.0 325.0 429.0 273.0 
263.0 256.0 343.0 405.0 284.0 236.0 369.0 321.0 271.0 348.0 309.0 371.0 308.0 311.0 387.0 315.0 
309.0 312.0 357.0 430.0 384.0 343.0 369.0 385.0 361.0 332.0 395.0 430.0 384.0 427.0 460.0 355.0 
310.0 236.0 371.0 352.0 293.0 308.0 312.0 384.0 403.0 268.0 416.0 361.0 292.0 378.0 450.0 323.0 
202.0 302.0 399.0 411.0 370.0 299.0 383.0 226.0 259.0 338.0 250.0 374.0 281.0 334.0 385.0 255.0 
257.0 249.0 337.0 388.0 339.0 252.0 385.0 380.0 279.0 259.0 304.0 441.0 294.0 300.0 389.0 285.0 
324.0 292.0 385.0 480.0 320.0 362.0 471.0 360.0 313.0 397.0 456.0 490.0 326.0 429.0 433.0 304.0 
372.0 279.0 421.0 457.0 370.0 399.0 417.0 426.0 388.0 342.0 449.0 477.0 330.0 437.0 489.0 355.0 
203.0 196.0 216.0 262.0 250.0 233.0 230.0 248.0 143.0 185.0 205.0 242.0 191.0 257.0 243.0 240.0 
235.0 221.0 353.0 357.0 291.0 313.0 376.0 239.0 217.0 381.0 318.0 389.0 236.0 270.0 381.0 324.0 
253.0 245.0 365.0 385.0 293.0 308.0 361.0 358.0 338.0 273.0 355.0 402.0 278.0 375.0 371.0 258.0 
210.0 263.0 342.0 343.0 336.0 283.0 351.0 299.0 236.0 252.0 223.0 328.0 247.0 294.0 351.0 271.0 
177.0 187.0 326.0 282.0 242.0 199.0 231.0 191.0 275.0 269.0 244.0 262.0 271.0 240.0 378.0 257.0 
297.0 196.0 338.0 346.0 302.0 307.0 320.0 344.0 310.0 273.0 381.0 418.0 270.0 334.0 402.0 297.0 

CPU Result (C = A * B):
321.0 250.0 315.0 423.0 316.0 239.0 393.0 359.0 282.0 349.0 378.0 445.0 389.0 350.0 423.0 309.0 
328.0 281.0 419.0 433.0 356.0 317.0 401.0 302.0 353.0 400.0 348.0 435.0 387.0 376.0 503.0 364.0 
302.0 216.0 298.0 327.0 290.0 289.0 286.0 286.0 308.0 264.0 313.0 280.0 320.0 325.0 429.0 273.0 
263.0 256.0 343.0 405.0 284.0 236.0 369.0 321.0 271.0 348.0 309.0 371.0 308.0 311.0 387.0 315.0 
309.0 312.0 357.0 430.0 384.0 343.0 369.0 385.0 361.0 332.0 395.0 430.0 384.0 427.0 460.0 355.0 
310.0 236.0 371.0 352.0 293.0 308.0 312.0 384.0 403.0 268.0 416.0 361.0 292.0 378.0 450.0 323.0 
202.0 302.0 399.0 411.0 370.0 299.0 383.0 226.0 259.0 338.0 250.0 374.0 281.0 334.0 385.0 255.0 
257.0 249.0 337.0 388.0 339.0 252.0 385.0 380.0 279.0 259.0 304.0 441.0 294.0 300.0 389.0 285.0 
324.0 292.0 385.0 480.0 320.0 362.0 471.0 360.0 313.0 397.0 456.0 490.0 326.0 429.0 433.0 304.0 
372.0 279.0 421.0 457.0 370.0 399.0 417.0 426.0 388.0 342.0 449.0 477.0 330.0 437.0 489.0 355.0 
203.0 196.0 216.0 262.0 250.0 233.0 230.0 248.0 143.0 185.0 205.0 242.0 191.0 257.0 243.0 240.0 
235.0 221.0 353.0 357.0 291.0 313.0 376.0 239.0 217.0 381.0 318.0 389.0 236.0 270.0 381.0 324.0 
253.0 245.0 365.0 385.0 293.0 308.0 361.0 358.0 338.0 273.0 355.0 402.0 278.0 375.0 371.0 258.0 
210.0 263.0 342.0 343.0 336.0 283.0 351.0 299.0 236.0 252.0 223.0 328.0 247.0 294.0 351.0 271.0 
177.0 187.0 326.0 282.0 242.0 199.0 231.0 191.0 275.0 269.0 244.0 262.0 271.0 240.0 378.0 257.0 
297.0 196.0 338.0 346.0 302.0 307.0 320.0 344.0 310.0 273.0 381.0 418.0 270.0 334.0 402.0 297.0 

Matrix dimensions: 16x16 * 16x16 = 16x16
GPU time: 0.29 ms
CPU time: 0.01 ms
Speedup: 0.05x
Results match!
```
